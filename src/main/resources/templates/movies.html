<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Movies</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/app.css}">
</head>
<body>

<!-- NAVBAR (fragment) -->
<div th:replace="~{fragments/navbar :: navbar('movies')}"></div>

<main class="container py-4 py-md-5">

    <!-- TOP: day tabs + date picker -->
    <section class="mb-4">
        <div class="d-flex align-items-center justify-content-between flex-wrap gap-3">

            <!-- Day tabs (UI only for now; only "Today" actually navigates) -->
            <div class="d-flex gap-3 gap-md-4 align-items-center flex-wrap">
                <a class="link-light fw-semibold text-decoration-none" th:href="@{/movies}">Today</a>
                <a class="link-light fw-semibold text-decoration-none opacity-75" href="#">Wed</a>
                <a class="link-light fw-semibold text-decoration-none opacity-75" href="#">Thu</a>
                <a class="link-light fw-semibold text-decoration-none opacity-75" href="#">Fri</a>
                <a class="link-light fw-semibold text-decoration-none opacity-75" href="#">Sat</a>
                <a class="link-light fw-semibold text-decoration-none opacity-75" href="#">Sun</a>
                <a class="link-light fw-semibold text-decoration-none opacity-75" href="#">Mon</a>
            </div>

            <!-- Date picker + format (UI only for now) -->
            <form class="d-flex gap-2 align-items-center" method="get" th:action="@{/movies}">
                <input class="form-control" type="date" name="date" th:value="${selectedDate}">
                <input type="hidden" name="q" th:value="${q}">
                <button class="btn btn-outline-light" type="submit">Go</button>

                <select class="form-select">
                    <option selected>Choose format</option>
                    <option>2D</option>
                    <option>3D</option>
                    <option>IMAX</option>
                </select>
            </form>
        </div>

        <div class="mt-3" style="color: var(--muted); font-size: 1.1rem;" th:text="${selectedDateLabel}">
            Tuesday, 06/01/2026
        </div>
    </section>

    <!-- MOVIES: vertical list -->
    <section class="d-flex flex-column gap-4">

        <article class="card p-3 p-md-4" th:each="m : ${movies}">
            <div class="row g-3 g-md-4 align-items-start">

                <!-- Poster -->
                <div class="col-12 col-md-3 col-lg-2">
                    <div class="ratio ratio-2x3 rounded overflow-hidden" style="background: rgba(255,255,255,0.06);">
                        <img class="w-100 h-100" style="object-fit: cover;"
                             th:src="@{${m.imageUrl}}"
                             alt="Poster"
                             onerror="this.style.display='none'">
                    </div>
                </div>

                <!-- Info + showtimes -->
                <div class="col-12 col-md-9 col-lg-10">

                    <!-- Title + badges -->
                    <div class="d-flex align-items-center gap-2 flex-wrap">
                        <h2 class="h4 m-0" th:text="${m.title}">Movie title</h2>
                        <span class="badge badge-soft" th:text="${m.rating}">AP-12</span>
                        <span class="badge badge-soft" th:text="${m.genre}">Sci-Fi</span>
                        <span class="badge badge-soft" th:text="${m.duration}">166 min</span>
                        <span class="badge badge-soft" th:text="${m.priceLei} + ' lei'">30 lei</span>
                    </div>

                    <!-- Format + language (taken from first showtime, if present) -->
                    <div class="d-flex gap-2 flex-wrap mt-2" th:if="${!#lists.isEmpty(m.showtimes)}">
                        <span class="badge badge-soft" th:text="${m.showtimes[0].format}">2D</span>
                        <span class="badge badge-soft" th:text="${m.showtimes[0].language}">EN (SUB RO)</span>
                    </div>

                    <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mt-3">
                        <!-- Showtime buttons (direct to booking) -->
                        <div class="d-flex flex-wrap gap-2">
                            <a class="btn btn-primary"
                               th:each="s : ${m.showtimes}"
                               th:href="@{/booking(showId=${s.id})}">
                                <span th:text="${s.time}">18:10</span>
                            </a>
                        </div>

                        <!-- Details button (to detailed movie page) -->
                        <a class="btn btn-outline-light"
                           th:href="@{/movies/{id}(id=${m.id}, date=${selectedDate})}">
                            Detalii
                        </a>
                    </div>

                </div>
            </div>
        </article>

    </section>

</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
